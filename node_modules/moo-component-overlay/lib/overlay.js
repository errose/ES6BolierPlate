var $ = require('jquery');
var Openable = require('moo-jsutil-openable');

Overlay = (function () {

  var overlay = {};

  overlay.init = function () {
    var self = this;
    $(document)
      .on('click', '[data-overlay-trigger]', function(e){
        e.preventDefault();
        var target = $(this).attr('href'),
            action = $(this).attr('data-overlay-trigger');
        self.toggle(target, action);
      })
      .on('keyup', function(e){
        var target = '#'+$('.Overlay.is-open').attr('id');
        if (e.keyCode === 27) {
          self.toggle(target, false);
        }
      });
  };
  overlay.toggle = function (target, action) {
    if(action !== ''){
      action = setAction(action);
    }
    Openable.toggle(target, action);
    Openable.toggle('body', action);
  };

  var setAction = function(action){
    return action === 'open' ? true : false;
  };

  return overlay;

})();

module.exports = Overlay;
